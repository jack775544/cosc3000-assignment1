<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Heatmaps</title>
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
<div id="floating-panel">
    <button onclick="toggleHeatmap()">Toggle Heatmap</button>
    <button onclick="getBounds()">Get Bounds</button>
    <button onclick="changeRadius()">Change radius</button>
    <button onclick="changeOpacity()">Change opacity</button>
</div>
<div id="map"></div>
<script type="application/javascript" src="js/jquery.min.js"></script>
<script>

    // This example requires the Visualization library. Include the libraries=visualization
    // parameter when you first load the API. For example:
    // <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&libraries=visualization">

    var map, heatmap, b;
    var points = [];

    function initMap() {
        $.get('api/points/all', function(r){
            for (var i = 0; i < r.length; i++) {
                var e = r[i];
                points.push(new google.maps.LatLng(e.lat, e.long));
            }
            map = new google.maps.Map(document.getElementById('map'), {
                zoom: 10,
                center: {lat: -27.5, lng: 153},
                mapTypeId: 'roadmap'
            });

            heatmap = new google.maps.visualization.HeatmapLayer({
                data: points,
                map: map
            });
        });
    }

    function toggleHeatmap() {
        heatmap.setMap(heatmap.getMap() ? null : map);
    }

    function getBounds() {
        console.log(map.getBounds());
        console.log(map.getBounds().getNorthEast());
        console.log(map.getBounds().getNorthEast().lat());
        console.log(map.getBounds().getNorthEast().lng());
        console.log(map.getBounds().getSouthWest());
        console.log(map.getBounds().getSouthWest().lat());
        console.log(map.getBounds().getSouthWest().lng());
    }

    function changeRadius() {
        heatmap.set('radius', heatmap.get('radius') ? null : 20);
    }

    function changeOpacity() {
        heatmap.set('opacity', heatmap.get('opacity') ? null : 0.2);
    }

    // Heatmap data: 500 Points
    function getPoints() {
        return [
            new google.maps.LatLng(37.782551, -122.445368),
            new google.maps.LatLng(37.782745, -122.444586),
            new google.maps.LatLng(37.782842, -122.443688),
            new google.maps.LatLng(37.782919, -122.442815),
            new google.maps.LatLng(37.782992, -122.442112),
            new google.maps.LatLng(37.783100, -122.441461),
            new google.maps.LatLng(37.783206, -122.440829),
            new google.maps.LatLng(37.783273, -122.440324),
            new google.maps.LatLng(37.783316, -122.440023),
            new google.maps.LatLng(37.783357, -122.439794),
            new google.maps.LatLng(37.783371, -122.439687),
            new google.maps.LatLng(37.783368, -122.439666),
            new google.maps.LatLng(37.783383, -122.439594),
            new google.maps.LatLng(37.783508, -122.439525),
            new google.maps.LatLng(37.783842, -122.439591),
            new google.maps.LatLng(37.784147, -122.439668),
            new google.maps.LatLng(37.784206, -122.439686)
        ];
    }
</script>
<script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBgrNdnGfvih6kvIBfvLj6pkgwXmx321mQ&libraries=visualization&callback=initMap">
</script>
</body>
</html>